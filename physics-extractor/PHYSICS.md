# Bonk.io Physics Notes

This document will grow as we collect more recordings with `physics-extractor/1.js` and crunch the data in `analyze_jumps.py`.

## Dataset `0-jumps-up-tap`

- Scenario: player on a flat, non-bouncy platform, tapping the UP key roughly once every ~1.5 s.
- Recording cadence ≈120 Hz, but each frame is duplicated (exact same timestamp/position pair). The analysis script deduplicates by keeping the last sample per timestamp.
- Resting Y coordinate: **394.48 px**. Horizontal position is constant (we stood still).
- Detected 11 clean jumps. Six reach **11.0 px** above the floor, five reach **10.23 px**. The shorter group likely corresponds to under-held taps (human timing error). Plot files live in `physics-extractor/analysis/`.

| Jump group | Apex height (px) | Apex time (s) | Total airtime (s) | Takeoff velocity (px/s) | Gravity (px/s²) |
|------------|-----------------|---------------|-------------------|-------------------------|-----------------|
| “Full” tap (6 hops) | 11.00 | 0.50 | ≈1.00 | -40.4 | 81.0 |
| Short tap (5 hops) | 10.23 | 0.48 | ≈0.97 | -39.3 | 81.0 |

Gravity is very stable across all jumps: **~81 px/s²** downward. The normalized jump curves overlay perfectly, indicating a simple constant-acceleration parabola (no measurable air drag in this test).

## Known limitations / next actions

- **Input consistency**: human taps introduce ~0.8 px differences in apex height. Use an automated key tapper (e.g., ydotool or a PIXI ticker helper inside the injector) to nail single-frame presses.
- **Pixel scaling**: 81 px/s² depends on the camera zoom; we need to log a conversion factor (player diameter in px, block widths, etc.) to express gravity in world units that survive zoom changes.
- **Future experiments**: test multi-frame holds to map jump strength vs. hold time, record horizontal motion to measure acceleration/drag, and gather data on bouncy surfaces.

Update this document as new recordings are analyzed so we build a full physics profile over time.

## Dataset `0-tap-up` (zoom sweep)

- Setup: updated spy script `3.js` logs ball width/height. Jump input generated by a ydotool macro that taps UP once per ~1.5 s, eliminating human timing noise.
- Map zoom varied via the editor’s size slider (`size_1` = most zoomed in, `size_13` = most zoomed out). Recordings live under `physics-extractor/data/0-tap-up/bonk_jump_map_size_*.csv`.
- Analyze with `python analyze_jumps.py data/0-tap-up`. The script now handles directories, prints per-file stats, and summarizes everything normalized by on-screen ball diameter.

| Dataset | Ball diameter (px) | Apex (px) | Apex (ball diameters) | Gravity (px/s²) | Gravity (ball diameters/s²) |
|---------|-------------------:|----------:|----------------------:|----------------:|-----------------------------:|
| size_13 | 16.27 | 19.56 | 1.20 | 155.0 | 9.53 |
| size_12 | 19.52 | 23.47 | 1.20 | 186.0 | 9.53 |
| size_9  | 29.28 | 35.18 | 1.20 | 278.5 | 9.51 |
| size_6  | 42.30 | 50.77 | 1.20 | 400.7 | 9.47 |
| size_4  | 55.31 | 66.39 | 1.20 | 524.3 | 9.48 |
| size_3  | 65.07 | 78.09 | 1.20 | 616.5 | 9.47 |
| size_2  | 81.34 | 97.56 | 1.20 | 768.7 | 9.45 |
| size_1  | 97.61 | 122.64 | 1.26† | 918.2 | 9.41 |

† size_1 contained one slightly taller jump (likely two-frame hold); the other five hops match the 1.20 ball apex.

**Takeaways**

- Gravity in raw pixels/s² scales linearly with zoom: halving the on-screen ball size roughly halves the measured gravity.
- After normalizing by the ball diameter, gravity clusters tightly between **9.41–9.53** ball-diameters/s² (mean across 49 jumps: **9.48 ± 0.04**). This implies the underlying physics uses fixed world units; the renderer simply scales everything.
- Apex height also sits at ~1.20 ball diameters with single-frame taps, so “full jump” height is effectively independent of zoom once scaled.
- The analysis script’s normalized outputs give us a zoom-proof reference for future experiments (multi-frame holds, sideways motion, different materials, etc.).

**Working assumptions going forward**

- We define the Bonk ball diameter as **1 meter**. Every measurement expressed “in meters” uses this conversion.
- Canonical gravity will be **9.5 m/s²** for simulations and models, with domain randomization spanning roughly **9.0–10.0 m/s²** to cover observed variation (9.41–9.53).
- The current scope is Bonk.io only, so all future experiments inherit this unit system and gravity estimate unless new data suggests otherwise.

## Dataset `1-hold-up` (continuous jump hold)

- Procedure: from rest on a flat, non-bouncy surface, start recording, hold the UP key continuously via ydotool, let the character auto-hop several times, release, then stop the recording (`physics-extractor/data/1-hold-up/size*.csv`).
- Each “steady” hop (≈2.4 s airtime) shows a much lower downward acceleration because the constant UP input counteracts gravity throughout the flight. Very long segments (≈5–12 s) come from the moment we stopped holding UP; they behave like normal gravity and are excluded from the summary below.
- Filtering to hops with durations between 1.5 s and 5 s yields the following net downward accelerations (values are already normalized by ball diameter):

| Dataset | Ball diameter (px) | Steady hop apex (ball) | Net downward accel (ball/s²) |
|---------|-------------------:|-----------------------:|------------------------------:|
| size11  | 22.78 | 2.87 | 3.81 |
| size6   | 42.30 | 2.87 | 3.81 |
| size4   | 55.31 | 2.87 | 3.81 |
| size2   | 81.34 | *(need more samples)* | *(n/a)* |

**Interpretation**

- While UP is held, the player experiences a net downward acceleration of **3.81 ± 0.003 ball-diameters/s²** (~3.81 m/s²). Given our independent gravity measurement of 9.5 m/s², this implies the UP thrust contributes an upward acceleration of about **5.7 m/s²** every frame the key is held.
- Continuous holds roughly double the airtime (≈2.4 s) and push the apex to ~2.9 ball diameters (~2.9 m).
- When the key is released, the downward acceleration snaps back to 9.5 m/s² instantly, which matches what you feel in-game (a hard drop).
- Next data pass: capture additional runs at the extreme zooms (size13/size1) to confirm the thrust remains constant there too, and fill in size2 for completeness.

## Dataset `2-hold-horizontal` (continuous lateral hold)

- Custom map: long flat strip with non-bouncy floor plus non-bouncy walls at both ends. Start flush against one wall, begin recording, hold LEFT/RIGHT continuously to accelerate toward the opposite wall, collide (instant stop), then hold the opposite key to traverse back. Repeat several times before stopping the recording. Files live in `physics-extractor/data/2-hold-horizontal/`.
- Run `python analyze_jumps.py --mode horizontal data/2-hold-horizontal` to detect each constant-thrust segment, fit `x(t) = ½ a t² + v₀ t + x₀`, and report accelerations / end velocities in both px/s² and ball-diameters per second².
- Results below summarize runs that met the default filters (speed > 50 px/s, duration ≥ 0.4 s):

| Dataset | Ball diameter (px) | Runs | Mean accel (ball/s²) | Mean |v| (ball/s) | Max |v| observed (ball/s) |
|---------|-------------------:|-----:|---------------------:|----------------:|----------------------:|-------------------------:|
| 13 | 16.27 | 28 | 5.36 ± 0.55 | 17.18 | 25.36 |
| 11 | 22.78 | 16 | 5.48 ± 0.20 | 14.14 | 21.27 |
| 9  | 29.28 | 32 | 5.49 ± 0.33 | 13.88 | 18.80 |
| 5  | 48.80 | 23 | 5.47 ± 0.51 | 10.37 | 14.56 |

**Interpretation**

- Holding LEFT or RIGHT produces a horizontal acceleration of **≈5.45 ball-diameters/s²** (≈5.45 m/s²), independent of zoom once normalized. This is on par with the UP thrust strength, so the Bonk engine uses essentially the same per-frame force budget in X and Y.
- No horizontal drag or terminal velocity showed up in the logs: speed increases linearly with time until the ball hits a wall. The maximum recorded speed (with ~4 s of thrust at size13) was **25 ball/s** (~25 m/s).
- Because we accelerated back and forth between finite walls, the mean terminal speeds vary mostly with how long we could thrust before each collision (smaller maps → less time → smaller `|v|`).
- Future work: capture “release” behavior (tap RIGHT and let go before hitting a wall) to measure friction when no keys are held, and record air-control tests (hold RIGHT while airborne) to see if the same thrust applies mid-air.

## Next high-priority experiment

Record a **single-frame horizontal tap / release** (press RIGHT or LEFT briefly, let go before hitting a wall) both on the ground and mid-air. Logging `X_px` / `BallWidth_px` during those motions will let us:

- Measure how quickly horizontal velocity decays with no input (ground friction vs. air drag).
- Compare ground vs. air thrust to see if the 5.45 m/s² figure holds while airborne.
- Capture any coupling when UP and RIGHT are pressed together.

Reuse the ydotool macro for precise durations, then run `analyze_jumps.py --mode horizontal ... --trim-ms 100` (if needed) to fit each segment just like we did for the constant-hold runs.
